<app-main-header titulo="Cambiar contraseña"></app-main-header>

<ion-content class="cambiar-pass-content theme-light">
  <div class="page-wrapper">
    <!-- Cabecera de la sección -->
    <div class="page-header">
      <div>
        <h1>Seguridad de la cuenta</h1>
        <p class="subtitle">
          Actualiza tu contraseña para proteger el acceso a la Plataforma IoT Compost.
        </p>
      </div>
    </div>

    <!-- Card principal -->
    <ion-card class="panel">
      <ion-card-header>
        <ion-card-subtitle>Credenciales</ion-card-subtitle>
        <ion-card-title>Actualizar contraseña</ion-card-title>
      </ion-card-header>

      <ion-card-content>
        <form [formGroup]="form" (ngSubmit)="onSubmit()">
          <!-- Contraseña actual -->
          <ion-item lines="full">
            <ion-label position="stacked">Contraseña actual</ion-label>
            <ion-input
              type="password"
              autocomplete="current-password"
              formControlName="actual"
            ></ion-input>
          </ion-item>
          <div
            class="field-error"
            *ngIf="f.actual.touched && f.actual.invalid"
          >
            Ingresa tu contraseña actual.
          </div>

          <!-- Nueva contraseña -->
          <ion-item lines="full">
            <ion-label position="stacked">Nueva contraseña</ion-label>
            <ion-input
              type="password"
              autocomplete="new-password"
              formControlName="nueva"
            ></ion-input>
          </ion-item>
          <div
            class="field-error"
            *ngIf="f.nueva.touched && f.nueva.invalid"
          >
            La nueva contraseña debe tener al menos 8 caracteres.
          </div>

          <!-- Confirmación -->
          <ion-item lines="full">
            <ion-label position="stacked">Confirmar nueva contraseña</ion-label>
            <ion-input
              type="password"
              autocomplete="new-password"
              formControlName="confirmar"
            ></ion-input>
          </ion-item>
          <div
            class="field-error"
            *ngIf="f.confirmar.touched && f.confirmar.invalid"
          >
            Confirma la nueva contraseña.
          </div>

          <!-- Hint ecológico / seguridad -->
          <div class="password-hint">
            <ion-icon name="shield-checkmark-outline"></ion-icon>
            <p>
              Te recomendamos una contraseña de al menos 8 caracteres,
              combinando mayúsculas, minúsculas, números y símbolos.
              Evita usar datos personales o claves de otros sistemas.
            </p>
          </div>

          <!-- Acciones -->
          <div class="form-actions">
            <ion-button
              type="submit"
              [disabled]="form.invalid || guardando"
            >
              <ion-icon name="save-outline" slot="start"></ion-icon>
              Guardar cambios
            </ion-button>
          </div>
        </form>
      </ion-card-content>
    </ion-card>
  </div>
</ion-content>
